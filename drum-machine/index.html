<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Drum Machine</title>
    <!-- REACT -->
    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
    <!-- markdown -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.5.0/marked.js"></script>

    <link href="https://fonts.googleapis.com/css?family=Raleway:400,700" rel="stylesheet">

    <style>
      body {
        font-family: 'Raleway', sans-serif;
        padding-top: 50px;
      }

    </style>

  </head>

  <body>
    <!-- HTML -->
    <div id="drum-machine"></div>

    <!-- REACT -->
    <script type="text/babel">


    const sounds = [{
        keyCode: 81,
        keyTrigger: 'Q',
        id: 'Heater-1',
        url: 'https://s3.amazonaws.com/freecodecamp/drums/Heater-1.mp3'
      }, {
        keyCode: 87,
        keyTrigger: 'W',
        id: 'Heater-2',
        url: 'https://s3.amazonaws.com/freecodecamp/drums/Heater-2.mp3'
      }, {
        keyCode: 69,
        keyTrigger: 'E',
        id: 'Heater-3',
        url: 'https://s3.amazonaws.com/freecodecamp/drums/Heater-3.mp3'
      }, {
        keyCode: 65,
        keyTrigger: 'A',
        id: 'Heater-4',
        url: 'https://s3.amazonaws.com/freecodecamp/drums/Heater-4_1.mp3'
      }, {
        keyCode: 83,
        keyTrigger: 'S',
        id: 'Clap',
        url: 'https://s3.amazonaws.com/freecodecamp/drums/Heater-6.mp3'
      }, {
        keyCode: 68,
        keyTrigger: 'D',
        id: 'Open-HH',
        url: 'https://s3.amazonaws.com/freecodecamp/drums/Dsc_Oh.mp3'
      }, {
        keyCode: 90,
        keyTrigger: 'Z',
        id: "Kick-n'-Hat",
        url: 'https://s3.amazonaws.com/freecodecamp/drums/Kick_n_Hat.mp3'
      }, {
        keyCode: 88,
        keyTrigger: 'X',
        id: 'Kick',
        url: 'https://s3.amazonaws.com/freecodecamp/drums/RP4_KICK_1.mp3'
      }, {
        keyCode: 67,
        keyTrigger: 'C',
        id: 'Closed-HH',
        url: 'https://s3.amazonaws.com/freecodecamp/drums/Cev_H2.mp3'
      },
    ];

    class App extends React.Component {
      constructor(props) {
        super(props);
        this.state = {
          currentKey: '',
          url: '',
          id: '',
          keyTrigger: ''
        };
      }

      componentDidMount() {
      document.addEventListener('keydown', this.handleKeyPress);
      console.log('keydown');
      }

      componentWillUnmount() {
      document.removeEventListener('keydown', this.handleKeyPress);
      console.log('unmount keydown');
      }

      handleKeyPress = (event) => {
        this.setState({
          currentKey: '',
          url: '',
          id: ''
        });
        console.log('reset state');
        for (let i = 0; i < sounds.length; i++) {
          if (event.keyCode === sounds[i].keyCode) {
            this.setState({
              currentKey: event.keyCode,
              url: sounds[i].url,
              id: sounds[i].id,
              keyTrigger: sounds[i].keyTrigger
            });
            console.log('set state');
            console.log(this.state.url);
          }
        };
        let audio = document.getElementById(this.state.keyTrigger);
        audio.play();
        console.log('play');
      };

      mouseOverHandler = (event) => {
        console.log("event " + event.type);
        console.log("event " + event.target.id);
        console.log("this " + this);
        for (let i = 0; i < sounds.length; i++) {
          if (sounds[i].id === event.target.id) {
            this.setState({
              currentKey: sounds[i].keyCode,
              url: sounds[i].url,
              id: event.target.id,
              keyTrigger: sounds[i].keyTrigger
            });

          }
        }
      };

      clickToPlayHandler = () => {
        console.log("change state");
        console.log(this.state.keyTrigger);
        console.log("stateurl " + this.state.url)
        let audio = document.getElementById(this.state.keyTrigger);
        audio.play();
        console.log("play");
      };

      render() {
        console.log('render');
        return (
          <div>
          <button className="drum-pad" id='Heater-1'
            onClick={this.clickToPlayHandler}
            onMouseOver={this.mouseOverHandler}>Q
            <audio className='clip' id="Q" src={this.state.url}></audio>
          </button>
          <div className="drum-pad" id='Heater-2'
            onClick={this.clickToPlayHandler}
            onMouseOver={this.mouseOverHandler}>W
            <audio className='clip' id="W" src={this.state.url}></audio></div>
          <div className="drum-pad" id='Heater-3'
            onClick={this.clickToPlayHandler}
            onMouseOver={this.mouseOverHandler}>E
            <audio className='clip' id="E" src={this.state.url}></audio></div>
          <div className="drum-pad" id='Heater-4'
            onClick={this.clickToPlayHandler}
            onMouseOver={this.mouseOverHandler}>A
            <audio className='clip' id="A" src={this.state.url}></audio></div>
          <div className="drum-pad" id='Clap'
            onClick={this.clickToPlayHandler}
            onMouseOver={this.mouseOverHandler}>S
            <audio className='clip' id="S" src={this.state.url}></audio></div>
          <div className="drum-pad" id='Open-HH'
            onClick={this.clickToPlayHandler}
            onMouseOver={this.mouseOverHandler}>D
            <audio className='clip' id="D" src={this.state.url}></audio></div>
          <div className="drum-pad" id="Kick-n'-Hat"
            onClick={this.clickToPlayHandler}
            onMouseOver={this.mouseOverHandler}>Z
            <audio className='clip' id="Z" src={this.state.url}></audio></div>
          <div className="drum-pad" id='Kick'
            onClick={this.clickToPlayHandler}
            onMouseOver={this.mouseOverHandler}>X
            <audio className='clip' id="X" src={this.state.url}></audio></div>
          <div className="drum-pad" id='Closed-HH'
            onClick={this.clickToPlayHandler}
            onMouseOver={this.mouseOverHandler}>C
            <audio className='clip' id="C" src={this.state.url}></audio></div>

            <div id="display">
              {this.state.id}
            </div>

          </div>
        );
      }
    }

      ReactDOM.render(<App />, document.getElementById('drum-machine'));

    </script>

    <!-- FCC tests -->
    <script src="https://cdn.freecodecamp.org/testable-projects-fcc/v1/bundle.js"></script>
  </body>
</html>
